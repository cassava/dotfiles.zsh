- defaults:
    link:
      relink: true

- clean:
    - ~/
    - ~/.config/
    - ~/.local/bin/
    - ~/.profile.d/
    - ~/.zdir/

- shell:
  - description: Rename .profile to .bash_profile if it is a file
    command: >
      test -f ~/.bash_profile ||
      test -f ~/.profile      &&
      mv ~/.profile ~/.bash_profile

- link:
    ~/.config/:
      path: _config/*
      glob: true
      create: true
    ~/.dircolors: _dircolors
    ~/.inputrc: _inputrc
    ~/.local/bin/:
      path: _local/bin/*
      glob: true
      create: true
    ~/.profile: _profile
    ~/.profile.d/:
      path: _profile.d/*
      glob: true
      create: true
    ~/.tmux.conf: _tmux.conf
    ~/.zalias: _zalias
    ~/.zdir/:
      path: _zdir/*
      glob: true
      create: true
    ~/.zprofile: _zprofile
    ~/.zshrc: _zshrc

# Arch Linux packages
- shell:
  - description: Install core packages (Arch)
    command: >
      test -f /usr/bin/pacman  &&
      sudo pacman -Sy --needed --noconfirm  \
        fasd                    \
        fd                      \
        git                     \
        glances                 \
        inetutils               \
        mc                      \
        ripgrep                 \
        the_silver_searcher     \
        tmate                   \
        tmux                    \
        tree                    \
        zsh                     \
      || true
    stdin: true
    stdout: true
    stderr: true

# Ubuntu Bionic/Focal packages
- shell:
  - description: Install core packages (Arch)
    command: >
      test -x /usr/bin/apt     &&
      sudo apt update          &&
      sudo apt install -y       \
        mc                      \
        ripgrep                 \
        silversearcher-ag       \
        fasd                    \
        fd-find                 \
        inetutils-tools         \
        inetutils-ping          \
        inetutils-telnet        \
        glances                 \
        tree                    \
        tmate                   \
        tmux                    \
        zsh                     \
      || true
    stdin: true
    stdout: true
    stderr: true

# Check that locales are available
- shell:
  - description: Assert all locales are available
    command: _local/bin/check-locales --generate --auto-fix
    stdin: true
    stdout: true
    stderr: true
